{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "SPL Detection Rule Header Schema",
  "description": "Schema for CI-managed Splunk SPL detection rules",
  "type": "object",
  "required": [
    "CI-MANAGED",
    "DETECT_ID",
    "TITLE",
    "DESCRIPTION",
    "STATUS",
    "DATE",
    "MODIFIED",
    "LOGSOURCE_SERVICE"
  ],
  "properties": {
    "CI-MANAGED": {
      "type": "boolean",
      "description": "Whether the rule is managed by CI/CD"
    },
    "DETECT_ID": {
      "type": "string",
      "pattern": "^DETECT-[0-9]{4}-[0-9]{4}$",
      "description": "Internal detection identifier"
    },
    "TITLE": {
      "type": "string",
      "minLength": 5
    },
    "DESCRIPTION": {
      "type": "string",
      "minLength": 10
    },
    "STATUS": {
      "type": "string",
      "enum": [
        "draft",
        "test",
        "production",
        "deprecated"
      ]
    },
    "DATE": {
      "type": "string",
      "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}$"
    },
    "MODIFIED": {
      "type": "string",
      "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}$"
    },
    "LOGSOURCE_SERVICE": {
      "type": "string",
      "enum": [
        "sysmon",
        "security",
        "apache",
        "nginx",
        "iis",
        "tomcat",
        "owa",
        "sshd",
        "rdp",
        "dns",
        "dhcp",
        "windows_defender",
        "proxy"
      ]
    },
    "SPLUNK_MODE": {
      "type": "string",
      "enum": [
        "report",
        "alert"
      ],
      "default": "report"
    },
    "SPLUNK_CRON": {
      "type": "string",
      "default": "*/5 * * * *"
    },
    "SPLUNK_EARLIEST": {
      "type": "string",
      "default": "-5m"
    },
    "SPLUNK_LATEST": {
      "type": "string",
      "default": "now"
    },
    "SPLUNK_SEVERITY": {
      "type": "string",
      "enum": [
        "low",
        "medium",
        "high",
        "critical"
      ]
    }
  },
  "additionalProperties": true
}